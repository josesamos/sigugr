<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Workflow for Geographic Data â€¢ sigugr</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="apple-touch-icon-60x60.png">
<script src="deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="deps/headroom-0.11.0/headroom.min.js"></script><script src="deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="deps/search-1.0.0/fuse.min.js"></script><script src="deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="pkgdown.js"></script><meta property="og:title" content="Workflow for Geographic Data">
<meta name="description" content="Streamlines geographic data transformation, storage and publication, simplifying data preparation and enhancing interoperability across formats and platforms.">
<meta property="og:description" content="Streamlines geographic data transformation, storage and publication, simplifying data preparation and enhancing interoperability across formats and platforms.">
<meta property="og:image" content="https://josesamos.github.io/sigugr/logo.png">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="index.html">sigugr</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="articles/sigugr.html">Get started</a></li>
<li class="nav-item"><a class="nav-link" href="reference/index.html">Reference</a></li>
<li class="nav-item"><a class="nav-link" href="news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="search.json">
</form></li>
      </ul>
</div>


  </div>
</nav><div class="container template-home">
<div class="row">
  <main id="main" class="col-md-9"><div class="section level1">
<div class="page-header">
<img src="logo.png" class="logo" alt=""><h1 id="sigugr-workflow-for-geographic-data-">sigugr: Workflow for Geographic Data 
<a class="anchor" aria-label="anchor" href="#sigugr-workflow-for-geographic-data-"></a>
</h1>
</div>
<!-- badges: start -->

<p>The workflow for geographic data typically involves:</p>
<ul>
<li>Data acquisition: Many datasets are sourced from web downloads.<br>
</li>
<li>Data transformation: This includes tasks such as raster composition, resolution adjustments, clipping, reprojection, and style management.<br>
</li>
<li>Data storage: Storing the processed data in databases, such as PostGIS.<br>
</li>
<li>Data publication: Making the data accessible via platforms like GeoServer.</li>
</ul>
<p>The goal of the <code>sigugr</code> package is to provide a comprehensive set of functions that simplify the processes of transforming, storing, and publishing geographic data.</p>
<div class="section level2">
<h2 id="installation">Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h2>
<p>You can install the development version of sigugr from <a href="https://github.com/" class="external-link">GitHub</a> with:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># install.packages("pak")</span></span>
<span><span class="fu">pak</span><span class="fu">::</span><span class="fu"><a href="https://pak.r-lib.org/reference/pak.html" class="external-link">pak</a></span><span class="op">(</span><span class="st">"josesamos/sigugr"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="example">Example<a class="anchor" aria-label="anchor" href="#example"></a>
</h2>
<p>The satellite bands for a specific area were downloaded from <a href="https://glovis.usgs.gov/app?fullscreen=0" class="external-link">GloVis</a> (USGS Global Visualization Viewer). They were integrated and initially transformed using the <a href="https://CRAN.R-project.org/package=satres" class="external-link"><code>satres</code></a> package. To reduce their file size and enable inclusion here, their resolution was adjusted using the <code>aggregate_rasters</code> function provided by this package.</p>
<p>Figure 1 below shows the original satellite bands that we started with.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://josesamos.github.io/sigugr/">sigugr</a></span><span class="op">)</span></span>
<span></span>
<span><span class="va">tif</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"sat.tif"</span>, package <span class="op">=</span> <span class="st">"sigugr"</span><span class="op">)</span></span>
<span><span class="va">sat</span> <span class="op">&lt;-</span> <span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/rast.html" class="external-link">rast</a></span><span class="op">(</span><span class="va">tif</span><span class="op">)</span></span>
<span><span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">sat</span><span class="op">)</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<img src="reference/figures/README-web-usgs01-1.png" alt="Figure 1: Original satellite bands." width="80%"><p class="caption">
Figure 1: Original satellite bands.
</p>
</div>
<p>We are interested only in the area defined by a polygon representing a municipality in the region. Using the <code>clip_raster</code> function, we extract the area of interest. We can either preserve the original CRS of the bands or reproject them to the CRS of the clipping polygon, which is controlled by the <code>keep_crs</code> parameter.</p>
<p>The obtained result is shown in Figure 2.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">gpkg</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"sigugr.gpkg"</span>, package <span class="op">=</span> <span class="st">"sigugr"</span><span class="op">)</span></span>
<span><span class="va">polygon</span> <span class="op">&lt;-</span> <span class="fu">sf</span><span class="fu">::</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_read.html" class="external-link">st_read</a></span><span class="op">(</span><span class="va">gpkg</span>, layer <span class="op">=</span> <span class="st">"lanjaron"</span>, quiet <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="va">sat2</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/clip_raster.html">clip_raster</a></span><span class="op">(</span><span class="va">sat</span>, <span class="va">polygon</span>, keep_crs <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">sat2</span><span class="op">)</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<img src="reference/figures/README-clip-1.png" alt="Figure 2: Satellite bands cut by a polygon." width="80%"><p class="caption">
Figure 2: Satellite bands cut by a polygon.
</p>
</div>
<p>We save the result in a working file, which will be used for database storage and publication.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sat_file</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempfile</a></span><span class="op">(</span>fileext <span class="op">=</span> <span class="st">".tif"</span><span class="op">)</span></span>
<span><span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/writeRaster.html" class="external-link">writeRaster</a></span><span class="op">(</span><span class="va">sat2</span>, <span class="va">sat_file</span>, filetype <span class="op">=</span> <span class="st">"GTiff"</span>, overwrite <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p>We store the result in a PostGIS database using the <code>store_raster</code> function. The database must have the <code>postgis</code> and <code>postgis_raster</code> extensions enabled.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">conn</span> <span class="op">&lt;-</span> <span class="fu">DBI</span><span class="fu">::</span><span class="fu"><a href="https://dbi.r-dbi.org/reference/dbConnect.html" class="external-link">dbConnect</a></span><span class="op">(</span></span>
<span>  <span class="fu">RPostgres</span><span class="fu">::</span><span class="fu"><a href="https://rpostgres.r-dbi.org/reference/Postgres.html" class="external-link">Postgres</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  dbname <span class="op">=</span> <span class="st">"sigugr"</span>,</span>
<span>  host <span class="op">=</span> <span class="st">"localhost"</span>,</span>
<span>  user <span class="op">=</span> <span class="st">"user"</span>,</span>
<span>  password <span class="op">=</span> <span class="st">"password"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">tables</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/store_bands.html">store_bands</a></span><span class="op">(</span><span class="va">sat_file</span>, <span class="va">conn</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">DBI</span><span class="fu">::</span><span class="fu"><a href="https://dbi.r-dbi.org/reference/dbDisconnect.html" class="external-link">dbDisconnect</a></span><span class="op">(</span><span class="va">conn</span><span class="op">)</span></span></code></pre></div>
<p>The following Figure 3 shows the access from QGIS to one of the tables included in the database.</p>
<div class="figure" style="text-align: center">
<img src="reference/figures/qgis-postgis.png" alt="Figure 3: Accessing PostGIS from QGIS." width="100%"><p class="caption">
Figure 3: Accessing PostGIS from QGIS.
</p>
</div>
<p>To publish the raster bands in GeoServer, we must use the version stored in the file, as GeoServer does not support PostGIS as a source for raster data. We publish them using the <code>publish_raster</code> function.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">gso</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/geoserver.html">geoserver</a></span><span class="op">(</span></span>
<span>  url <span class="op">=</span> <span class="st">"http://localhost:8080/geoserver"</span>,</span>
<span>  user <span class="op">=</span> <span class="st">"admin"</span>,</span>
<span>  password <span class="op">=</span> <span class="st">"geoserver"</span>,</span>
<span>  workspace <span class="op">=</span> <span class="st">"sigugr"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">gso</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="reference/publish_bands.html">publish_bands</a></span><span class="op">(</span><span class="va">sat_file</span><span class="op">)</span></span></code></pre></div>
<p>The result can also be viewed from QGIS by accessing the GeoServer instance via WMS, as shown in Figure 4.</p>
<div class="figure" style="text-align: center">
<img src="reference/figures/qgis-geoserver.png" alt="Figure 4: Accessing GeoServer from QGIS." width="100%"><p class="caption">
Figure 4: Accessing GeoServer from QGIS.
</p>
</div>
<p>Except for the functions used to connect to PostGIS and GeoServer, as well as those for accessing layers in files, the following function calls have been used to clip and reproject the satellite bands, store them in PostGIS, and publish them in GeoServer:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Clip and reproject</span></span>
<span><span class="va">sat2</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/clip_raster.html">clip_raster</a></span><span class="op">(</span><span class="va">sat</span>, <span class="va">polygon</span>, keep_crs <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Store in PostGIS</span></span>
<span><span class="va">tables</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/store_bands.html">store_bands</a></span><span class="op">(</span><span class="va">sat_file</span>, <span class="va">conn</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Publish in GeoServer</span></span>
<span><span class="va">gso</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="reference/publish_bands.html">publish_bands</a></span><span class="op">(</span><span class="va">sat_file</span><span class="op">)</span></span></code></pre></div>
<p>Using data obtained from the web, we can easily transform, store, and publish it using the functions implemented in the package, as demonstrated in this example.</p>
</div>
</div>
  </main><aside class="col-md-3"><div class="license">
<h2 data-toc-skip>License</h2>
<ul class="list-unstyled">
<li><a href="LICENSE.html">Full license</a></li>
<li><small><a href="https://opensource.org/licenses/mit-license.php" class="external-link">MIT</a> + file <a href="LICENSE-text.html">LICENSE</a></small></li>
</ul>
</div>


<div class="citation">
<h2 data-toc-skip>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html#citation">Citing sigugr</a></li>
</ul>
</div>

<div class="developers">
<h2 data-toc-skip>Developers</h2>
<ul class="list-unstyled">
<li>Jose Samos <br><small class="roles"> Author, maintainer </small> <a href="https://orcid.org/0000-0002-4457-3439" target="orcid.widget" aria-label="ORCID" class="external-link"><span class="fab fa-orcid orcid" aria-hidden="true"></span></a> </li>
<li><a href="authors.html">More about authors...</a></li>
</ul>
</div>

<div class="dev-status">
<h2 data-toc-skip>Dev status</h2>
<ul class="list-unstyled">
<li><a href="https://github.com/josesamos/sigugr/actions/workflows/R-CMD-check.yaml" class="external-link"><img src="https://github.com/josesamos/sigugr/actions/workflows/R-CMD-check.yaml/badge.svg" alt="R-CMD-check"></a></li>
<li><a href="https://app.codecov.io/gh/josesamos/sigugr" class="external-link"><img src="https://codecov.io/gh/josesamos/sigugr/graph/badge.svg" alt="Codecov test coverage"></a></li>
</ul>
</div>

  </aside>
</div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Jose Samos.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer>
</div>





  </body>
</html>
